---
:description: Generated sheet for tcpdump
:tags:
- community
:shortcuts:
  :defaults:
    'Note: 173.194.40.120 => google.com': "\n"
    Intercepts all packets on eth0: "tcpdump -i eth0\n\n"
    Intercepts all packets from/to 173.194.40.120: "tcpdump host 173.194.40.120\n\n"
    "-nn => Disables name resolution for IP addresses and port numbers.": "tcpdump
      -nn -i any host 173.194.40.120 and port 80\n\n"
    output with '[|protocol]'.: "tcpdump -i any -A host 173.194.40.120 and port 80
      | grep 'User-Agent'\n\n"
    "-s0 => force ngrep to look at the entire packet. (Default snaplen: 65536 bytes)": "ngrep
      'User-Agent' host 173.194.40.120 and port 80\n\n"
    Intercepts all packets on all interfaces from / to 8.8.8.8 or 173.194.40.127 on port 80: "tcpdump
      'host ( 8.8.8.8 or 173.194.40.127 ) and port 80' -i any\n\n"
    Intercepts all packets SYN and FIN of each TCP session.: "tcpdump 'tcp[tcpflags]
      & (tcp-syn|tcp-fin) != 0'\n\n"
    To display SYN and FIN packets of each TCP session to a host that is not on our network: "tcpdump
      'tcp[tcpflags] & (tcp-syn|tcp-fin) != 0 and not src and dst net local_addr'\n\n"
    ? To display all IPv4 HTTP packets that come or arrive on port 80 and that contain
      only data (no SYN, FIN no, no packet containing an ACK)
    : "tcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2))
      != 0)'\n\n"
    Saving captured data: "tcpdump -w file.cap\n\n"
    Reading from capture file: "tcpdump -r file.cap\n\n"
    Change -x to -xx => show extra header (ethernet).: "tcpdump -x\n\n"
    Change -X to -XX => show extra header (ethernet).: "tcpdump -X\n\n"
