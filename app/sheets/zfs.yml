---
:description: Generated sheet for zfs
:tags:
- community
:shortcuts:
  :defaults:
    "${snapshot}  ZFS snapshot (name)": "\n\n"
    Pools: "\n"
    'Recommended: use entire devices rather than partitions': "zpool create ${pool}
      raidz1 ${device} ${device} ${device} [...]\n\n"
    'Recommended: use separate, fast, low-latency devices (e.g. NVMe)': |+
      zpool add ${pool} log mirror ${part} ${part}

      zpool add ${pool} cache ${part} ${part} [...]

    Remove log or cache components: "zpool remove zfs ${part} [...]\n\n"
    'Note: this will create the /etc/zfs/zpool.cache devices cache': "zpool import
      -d /dev/disk/by-id -aN\n\n"
    Import (enable) existing pool using the devices cache: "zpool import -c /etc/zfs/zpool.cache
      -aN\n\n"
    Export (disable) pool (e.g. before shutdown): "zpool export -a\n\n"
    List all (imported) pools: "zpool list\n\n"
    See pool status: "zpool status ${pool}\n\n"
    See detailed pool I/O statistics: "zpool iostat ${pool} -v\n\n"
    "(watch progress with 'zpool status')": |+
      zpool scrub ${pool}

      zpool replace ${pool} ${failed-device} ${new-device}

    'Note: redundant pools (mirror, raidz) will continue working in degraded state': "zpool
      detach ${pool} ${device}\n\n"
    'WARNING: MUST do before reusing a device/partition for other purposes': "zpool
      labelclear ${device}\n\n"
    Query pool configuration (properties): "zpool get all ${pool}\n\n"
    Change pool configuration (property): "zpool set <property>=<value> ${pool}\n\n"
    Dump the entire pool (commands) history: "zpool history ${pool}\n\n"
    More...: |
      man zpool


      man zfs
    File systems / Volumes: "\n"
    Create a new file system: "zfs create ${pool}/${fs_vol}\n\n"
    'Note: look for it in /dev/zvol/${pool}/${fs_vol}': "zfs create -V <size> ${pool}/${fs_vol}\n\n"
    List all file systems / volumes: "zfs list\n\n"
    'Note: see ''zfs get mountpoint ${pool}'' for mountpoint root path': "zfs mount
      -a\n\n"
    Create a snapshot: "zfs snapshot ${pool}/${fs_vol}@${snapshot}\n\n"
    Delete a snapshot: "zfs destroy ${pool}/${fs_vol}@${snapshot}\n\n"
    "... on source:": |
      zfs send -p -R ${pool}/${fs_vol}@${snapshot}
      zfs send -p -R -i ${pool}/${fs_vol}@${snapshot-previous} ${pool}/${fs_vol}@${snapshot}
    "... on destination:": |+
      zfs receive -F ${pool}/${fs_vol}

      zfs receive -F ${pool}/${fs_vol}

    Query file system / volume configuration (properties): |+
      zfs get all ${pool}
      zfs get all ${pool}/${fs_vol}

    Change file system / volume configuration (property): "zfs set <property>=<value>
      ${pool}/${fs_vol}\n\n"
...
